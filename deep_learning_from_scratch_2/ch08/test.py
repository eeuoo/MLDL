import numpy as np

T, H = 5, 4
hs = np.random.randn(T, H)
a = np.array([0.8, 0.1, 0.03, 0.05, 0.02])

# repeat() 메서드는 다차원 배열의 원소를 복사하여 새로운 다차원 배열을 생성한다.
# 파라미터 = (복사를 반복하는 횟수, 반복하는 축(차원))
ar = a.reshape(5, 1).repeat(4, axis=1)
print(ar)
print(ar.shape)

# [[ 0.8   0.8   0.8   0.8 ]
#  [ 0.1   0.1   0.1   0.1 ]
#  [ 0.03  0.03  0.03  0.03]
#  [ 0.05  0.05  0.05  0.05]
#  [ 0.02  0.02  0.02  0.02]]
# (5, 4)

t = hs * ar
print(t)
print(t.shape)

# [[  5.30164898e-02   1.60530704e-01  -8.52291880e-01  -4.41438718e-01]
#  [ -5.13427348e-03   6.91899903e-03  -8.57023115e-02   1.32892359e-02]
#  [ -3.47415437e-02   1.54917593e-02  -6.57148405e-04   2.19817774e-02]
#  [  4.43727079e-02  -1.06966782e-02  -5.07544093e-03   1.24175776e-01]
#  [  3.62810085e-03  -8.44659090e-03   1.44623678e-02   8.27718033e-03]]
# (5, 4)

c = np.sum(t, axis=0)
print(c)
print(c.shape)

# [ 0.06114148  0.16379819 -0.92926441 -0.27371475]
# (4,)